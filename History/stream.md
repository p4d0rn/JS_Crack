ğŸ¯Targetï¼šdWdnYzovL2pqai5mY2J5dnBsLnBiei9nbGNyY2J5dnBs

ä¸€è¿›å»å°±æœ‰æ— é™debuggerï¼Œè¿™æ—¶å€™å³å‡»never pause hereå°±æ²¡ç”¨äº†ï¼Œå› ä¸ºæ— é™çš„å‡½æ•°è°ƒç”¨è®©å†…å­˜æº¢å‡ºäº†

æŸ¥çœ‹è°ƒç”¨æ ˆä¸Šä¸€ä¸ªå‡½æ•°

![image-20231006163524506](./../.gitbook/assets/image-20231006163524506.png)

æœ‰æ··æ·†ï¼Œæ”¾æ§åˆ¶å°æ‰“å°æŸ¥çœ‹å¾—åˆ°

`(function(){xxxx})['constructor']("debugger").call('action')`

å°±æ˜¯åˆ©ç”¨Functionå¯¹è±¡çš„æ„é€ å™¨æ„é€ äº†ä¸€ä¸ªdebugger

åˆ©ç”¨æ§åˆ¶å°hookï¼Œå½“ä¼ å…¥æ„é€ å™¨çš„å‚æ•°ä¸º`debugger`æ—¶è¿”å›ç©ºå‡½æ•°

```js
ctr = Function.prototype.constructor;
Function.prototype.constructor = function (name) {
    if(name === "debugger") {
        return function () {};
    }
    return ctr(name);
};
```

![image-20231006163005655](./../.gitbook/assets/image-20231006163005655.png)

å†ç‚¹å‡»å³ä¸‹è§’çš„Ctrl+Enterå®Œæˆhookï¼Œæ”¾è¡Œåå°±æ²¡æœ‰æ— é™debuggeräº†

ç‚¹å‡»å…¬ç¤ºå…¬å‘Š

![image-20231006170144940](./../.gitbook/assets/image-20231006170144940.png)

å‘ç°æ¥å£çš„è¯·æ±‚ä½“ä¸ºä¹±ç ï¼Œè¿”å›åŒ…ä¸ºæ­£å¸¸æ•°æ®

![image-20231006173721755](./../.gitbook/assets/image-20231006173721755.png)

ä¸‹XHRæ–­ç‚¹

![image-20231006173854483](./../.gitbook/assets/image-20231006173854483.png)

è¿™é‡Œçš„rå°±æ˜¯è¯·æ±‚ä½“ä¹±ç äº†ï¼Œå®ƒæ˜¯ç”±åŸå§‹æ•°æ®åŠ å¯†å¾—åˆ°çš„è¿›åˆ¶æ•°æ®æµ

å¾€ä¸Šå›æº¯ï¼Œå°è¯•æ‰¾åˆ°æ•°æ®åŠ å¯†ä½ç½®

![image-20231006174522116](./../.gitbook/assets/image-20231006174522116.png)

åˆ°è¿™é‡Œå¯ä»¥çœ‹åˆ°å·²ç»å¼€å§‹ç»„è£…è¯·æ±‚åŒ…äº†ï¼Œå†å¾€ä¸Šå›æº¯ï¼Œæ­¤æ—¶è°ƒç”¨çš„æ˜¯`Axios$1.request`ï¼Œç”¨è¿‡axiosçš„åº”è¯¥çŸ¥é“è¿™æ˜¯ä¸ªè¯·æ±‚æ‹¦æˆªå™¨

è¿™é‡Œåˆ«åˆ†éå†requestå’Œresponseæ‹¦æˆªå™¨å®šä¹‰çš„å‡½æ•°ï¼Œæ”¾å…¥nå’Œiï¼ˆè¿™é‡Œçš„thisæ˜¯`axiosInstance`ï¼Œåé¢è°ƒè¯•å¯çŸ¥ï¼‰

![image-20231006180321497](./../.gitbook/assets/image-20231006180321497.png)

è¿™é‡Œçš„eå°±å«æœ‰åŸå§‹çš„æ•°æ®

![image-20231006175230984](./../.gitbook/assets/image-20231006175230984.png)

nå’Œiå„æœ‰ä¸¤ä¸ªæ‹¦æˆªå‡½æ•°ï¼Œæœ€åæ‹¼æ¥åˆ°så¾—åˆ°`s = [n, dispatcherRequest, void 0, i]`

å¾ªç¯æ¡ä»¶ä¸º`s.length`ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šæ‰§è¡Œä¸¤æ¬¡`s.shift`ï¼Œå³æ¯æ¬¡å¾ªç¯é•¿åº¦å‡2ï¼Œè¯·æ±‚å‰æ‹¦æˆª + å‘é€è¯·æ±‚ + å“åº”åæ‹¦æˆªï¼Œä¸‰æ¬¡å¾ªç¯åˆšå¥½

æ¯æ¬¡å¾ªç¯éƒ½è¿›è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹JSçš„å¼‚æ­¥æ‰§è¡Œ

> åœ¨JavaScriptä¸­ï¼ŒPromiseæ˜¯ä¸€ç§ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„å¯¹è±¡ã€‚å®ƒä»£è¡¨äº†ä¸€ä¸ªå¯èƒ½å°šæœªå®Œæˆã€ä½†æœ€ç»ˆä¼šå®Œæˆå¹¶è¿”å›ç»“æœçš„æ“ä½œã€‚Promiseå¯¹è±¡å¯ä»¥ç”¨äºå¤„ç†è¯¸å¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ã€æ•°æ®åº“æŸ¥è¯¢ç­‰éœ€è¦ç­‰å¾…çš„æ“ä½œã€‚
>
> å½“ä¸€ä¸ªPromiseå¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œå®ƒå¤„äºPendingçŠ¶æ€ã€‚ä¸€æ—¦æ“ä½œå®Œæˆï¼Œå®ƒå¯ä»¥å˜ä¸ºFulfilledçŠ¶æ€ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™å˜ä¸ºRejectedçŠ¶æ€ã€‚åœ¨Promiseå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒçŠ¶æ€ä¸å¯é€†ã€‚
>
> Promiseå¯¹è±¡æä¾›äº†ä¸€äº›æ–¹æ³•æ¥å¤„ç†å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚å…¶ä¸­æœ€é‡è¦çš„æ–¹æ³•æ˜¯`then()`å’Œ`catch()`ã€‚
>
> `then(onFulfilled, onRejected)`æ–¹æ³•ç”¨äºæŒ‡å®šå½“Promiseå¯¹è±¡å˜ä¸ºFulfilledæˆ–RejectedçŠ¶æ€æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚`onFulfilled`å›è°ƒå‡½æ•°åœ¨Promiseå¯¹è±¡å˜ä¸ºFulfilledçŠ¶æ€æ—¶è°ƒç”¨ï¼Œæ¥æ”¶æ“ä½œçš„ç»“æœä½œä¸ºå‚æ•°ã€‚`onRejected`å›è°ƒå‡½æ•°åœ¨Promiseå¯¹è±¡å˜ä¸ºRejectedçŠ¶æ€æ—¶è°ƒç”¨ï¼Œæ¥æ”¶é”™è¯¯ä¿¡æ¯ä½œä¸ºå‚æ•°ã€‚
>
> `catch(onRejected)`æ–¹æ³•ç”¨äºæŒ‡å®šå½“Promiseå¯¹è±¡å˜ä¸ºRejectedçŠ¶æ€æ—¶è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚

è®©æˆ‘ä»¬è¿›å…¥ç¬¬ä¸€æ¬¡å¾ªç¯

![image-20231006181516267](./../.gitbook/assets/image-20231006181516267.png)

æ”¾æ§åˆ¶å°æ‰“å°ï¼Œå¾—åˆ°`axiosInstance.interceptors.request.use`ï¼Œç›´æ¥è·³åˆ°å‡½æ•°çš„æœ€åä¸€è¡Œè¿”å›å¤„ï¼Œå‘ç°æ­¤æ—¶è¯·æ±‚ä½“å·²ç»åŠ å¯†äº†ï¼Œå†å¾€ä¸Šçœ‹å§

![image-20231006183846635](./../.gitbook/assets/image-20231006183846635.png)

æ‰¾åˆ°äº†ä¿®æ”¹`r['data']`çš„åœ°æ–¹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ‰£ä»£ç äº†ã€‚

é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€æ®µä»£ç æ˜¯åœ¨VMä¸­æ‰§è¡Œäº†ï¼Œè¿™é‡Œçš„Writer

![image-20231006191826739](./../.gitbook/assets/image-20231006191826739.png)

Writerè·³è½¬åå´æ˜¯ä¸€ä¸ªåä¸ºdæ„é€ å‡½æ•°ï¼Œåé¢ä¹Ÿå®šä¹‰äº†ä¸€äº›VMä¸­åé¢ç”¨åˆ°çš„å‡½æ•°

![image-20231006192225356](./../.gitbook/assets/image-20231006192225356.png)

ç›²çŒœæ˜¯webpackçš„æ¨¡å—åŒ–å¤„ç†

å…¨æ–‡æœç´¢`Writer`ï¼Œæ‰¾åˆ°ä¸€å¤„`o.Writer = e(38)`ï¼Œå¾€ä¸Šæ‰¾eï¼Œå‘ç°ä¸€å¤§å † `x: []`ï¼Œéƒ½è¢«æ”¾åœ¨rè¿™ä¸ªå¯¹è±¡

![image-20231006192842522](./../.gitbook/assets/image-20231006192842522.png)

![image-20231006193039973](./../.gitbook/assets/image-20231006193039973.png)

ç¬¦åˆwebpackçš„ç‰¹å¾äº†ï¼ŒåŠ è½½å™¨ä¸ºi

![image-20231006200931675](./../.gitbook/assets/image-20231006200931675.png)

![image-20231006200847072](./../.gitbook/assets/image-20231006200847072.png)

